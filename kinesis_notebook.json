{"paragraphs":[{"text":"import com.amazonaws.regions.RegionUtils\nimport com.amazonaws.services.kinesis.clientlibrary.lib.worker.InitialPositionInStream\nimport org.apache.spark._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.types.{StringType, StructField, StructType}\nimport org.apache.spark.sql.{Row, SQLContext, SaveMode}\nimport org.apache.spark.storage._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.kinesis._\nimport org.json4s.jackson.JsonMethods.parse\nimport org.json4s.DefaultFormats\nimport org.json4s.jackson.JsonMethods.parse\nimport org.json4s.DefaultFormats\nimport org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"2017-08-22T15:34:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport com.amazonaws.regions.RegionUtils\n\nimport com.amazonaws.services.kinesis.clientlibrary.lib.worker.InitialPositionInStream\n\nimport org.apache.spark._\n\nimport org.apache.spark.rdd.RDD\n\nimport org.apache.spark.sql.types.{StringType, StructField, StructType}\n\nimport org.apache.spark.sql.{Row, SQLContext, SaveMode}\n\nimport org.apache.spark.storage._\n\nimport org.apache.spark.streaming._\n\nimport org.apache.spark.streaming.kinesis._\n\nimport org.json4s.jackson.JsonMethods.parse\n\nimport org.json4s.DefaultFormats\n\nimport org.json4s.jackson.JsonMethods.parse\n\nimport org.json4s.DefaultFormats\n\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1503410822135_-1318436211","id":"20170821-221927_2136648840","dateCreated":"2017-08-22T14:07:02+0000","dateStarted":"2017-08-22T15:34:49+0000","dateFinished":"2017-08-22T15:35:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:178"},{"text":"\n  val awsAccessKeyId = \"\"\n  val awsSecretKey = \"\"\n  val kinesisStreamName = \"iot-stream\"\n  val kinesisEndpointUrl = \"kinesis.us-east-1.amazonaws.com\"\n  val kinesisAppName = \"SBSStreamingReader\"\n  val kinesisCheckpointIntervalSeconds = 1\n  val batchIntervalSeconds = 60\n \n ","user":"anonymous","dateUpdated":"2017-08-22T21:00:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nawsAccessKeyId: String = AKIAIGY5ZRLFHS3DCGBQ\n\nawsSecretKey: String = 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\n\nkinesisStreamName: String = iot-stream\n\nkinesisEndpointUrl: String = kinesis.us-east-1.amazonaws.com\n\nkinesisAppName: String = SBSStreamingReader\n\nkinesisCheckpointIntervalSeconds: Int = 1\n\nbatchIntervalSeconds: Int = 60\n"}]},"apps":[],"jobName":"paragraph_1503410822146_-1630467569","id":"20170821-222013_738517647","dateCreated":"2017-08-22T14:07:02+0000","dateStarted":"2017-08-22T15:35:30+0000","dateFinished":"2017-08-22T15:35:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179"},{"text":"val ssc = new StreamingContext(sc, Seconds(batchIntervalSeconds))\n\n\n// Creata a Kinesis stream\nval kinesisStream =  (0 until 1).map { i =>\n  KinesisUtils.createStream(ssc,\n    kinesisAppName, kinesisStreamName,\n    kinesisEndpointUrl, RegionUtils.getRegionMetadata.getRegionByEndpoint(kinesisEndpointUrl).getName(),\n    InitialPositionInStream.LATEST, Seconds(kinesisCheckpointIntervalSeconds),\n    StorageLevel.MEMORY_AND_DISK_SER_2, awsAccessKeyId, awsSecretKey)\n}\n\nval unionStreams =ssc.union(kinesisStream)\n\nval sqlContext = new SQLContext(SparkContext.getOrCreate())\n\n//Processing each RDD and storing it in temporary table\nunionStreams.foreachRDD ((rdd: RDD[Array[Byte]], time: Time) => {\n \n\nval rowRDD = rdd.map(jstr => new String(jstr))\nval df = sqlContext.read.json(rowRDD)\ndf.createOrReplaceTempView(\"realTimeTable\")\nz.run(\"20170821-222346_757022702\")\n})\n\nz.run(\"20170821-222346_757022702\")","user":"anonymous","dateUpdated":"2017-08-22T15:44:42+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@78e6f6da\n\nkinesisStream: scala.collection.immutable.IndexedSeq[org.apache.spark.streaming.dstream.ReceiverInputDStream[Array[Byte]]] = Vector(org.apache.spark.streaming.kinesis.KinesisInputDStream@2f90b7f9)\n\nunionStreams: org.apache.spark.streaming.dstream.DStream[Array[Byte]] = org.apache.spark.streaming.dstream.UnionDStream@33750103\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@3743ed9e\n"}]},"apps":[],"jobName":"paragraph_1503410822147_-1630852318","id":"20170821-222256_1032448755","dateCreated":"2017-08-22T14:07:02+0000","dateStarted":"2017-08-22T15:44:42+0000","dateFinished":"2017-08-22T15:44:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:180"},{"text":"ssc.start()","user":"anonymous","dateUpdated":"2017-08-22T15:44:03+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njava.lang.IllegalStateException: Only one StreamingContext may be started in this JVM. Currently running StreamingContext was started atorg.apache.spark.streaming.StreamingContext.start(StreamingContext.scala:569)\n<init>(<console>:56)\n<init>(<console>:61)\n<init>(<console>:63)\n<init>(<console>:65)\n<init>(<console>:67)\n<init>(<console>:69)\n<init>(<console>:71)\n<init>(<console>:73)\n<init>(<console>:75)\n<init>(<console>:77)\n<init>(<console>:79)\n<init>(<console>:81)\n<init>(<console>:83)\n<init>(<console>:85)\n<init>(<console>:87)\n<init>(<console>:89)\n<init>(<console>:91)\n<init>(<console>:93)\n<init>(<console>:95)\n  at org.apache.spark.streaming.StreamingContext$.org$apache$spark$streaming$StreamingContext$$assertNoOtherContextIsActive(StreamingContext.scala:737)\n  at org.apache.spark.streaming.StreamingContext.start(StreamingContext.scala:571)\n  ... 56 elided\n"}]},"apps":[],"jobName":"paragraph_1503410822148_-1633160811","id":"20170821-222319_741082638","dateCreated":"2017-08-22T14:07:02+0000","dateStarted":"2017-08-22T15:44:03+0000","dateFinished":"2017-08-22T15:44:04+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:181"},{"text":"%sql select avg(deviceValue), deviceId  from  realTimeTable where deviceParameter = 'Temperature' group by deviceId","user":"anonymous","dateUpdated":"2017-08-22T15:42:08+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"deviceId","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(deviceValue)","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg(deviceValue)\tdeviceId\n29.2\tSBS05\n24.0\tSBS03\n16.0\tSBS01\n24.75\tSBS02\n"}]},"apps":[],"jobName":"paragraph_1503410822150_-1632006564","id":"20170821-222346_757022702","dateCreated":"2017-08-22T14:07:02+0000","dateStarted":"2017-08-22T15:44:46+0000","dateFinished":"2017-08-22T15:44:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:182"},{"text":"ssc.stop()\n","user":"anonymous","dateUpdated":"2017-08-22T14:51:20+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1503410822151_-1632391313","id":"20170821-222356_536490479","dateCreated":"2017-08-22T14:07:02+0000","dateStarted":"2017-08-22T14:51:20+0000","dateFinished":"2017-08-22T14:51:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:183"},{"dateUpdated":"2017-08-22T14:07:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1503410822153_-1634699807","id":"20170821-222543_1605676205","dateCreated":"2017-08-22T14:07:02+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:184"}],"name":"kinises","id":"2CSYX672R","angularObjects":{"2CQEFBXNJ:shared_process":[],"2CSGBZPM7:shared_process":[],"2CT4WHC92:shared_process":[],"2CSC12MVK:shared_process":[],"2CSTKSY14:shared_process":[],"2CQNWAWDW:shared_process":[],"2CQ9G121Z:shared_process":[],"2CRDQUCE4:shared_process":[],"2CQNH6QGP:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}